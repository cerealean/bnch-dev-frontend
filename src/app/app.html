<div class="container">
  <header class="header">
    <h1>JavaScript Performance Benchmarker</h1>
    <p class="description">
      This tool allows you to benchmark JavaScript code performance with statistical precision. 
      Simply enter your JavaScript code in the textarea below and click "Run Benchmark" to get 
      detailed performance metrics including execution time, operations per second, and statistical analysis.
      The code will be executed safely in an isolated environment to ensure accurate measurements.
    </p>
  </header>

  <main class="main-content">
    <div class="input-section">
      <textarea 
        [(ngModel)]="code" 
        placeholder="Enter your JavaScript code here to benchmark its performance..."
        class="code-input"
         id="main-benchmark-input" 
         name="main-benchmark-input"
        [disabled]="isRunning()"
        rows="20"
      ></textarea>
      
      <button 
        (click)="runBenchmark()" 
        [disabled]="isRunning() || !code().trim()"
        class="submit-button"
      >
        @if (isRunning()) {
          <span class="spinner"></span>
          Running Benchmark...
        } @else {
          Run Benchmark
        }
      </button>
    </div>

    @if (error()) {
      <div class="error-section">
        <h3>Error</h3>
        <p class="error-message">{{ error() }}</p>
      </div>
    }

    @if (result()) {
      <div class="results-section">
        <h2>Benchmark Results</h2>
        
        <mat-tab-group class="results-tabs" animationDuration="300ms">
          <!-- Overview Tab -->
          <mat-tab label="Overview">
            <div class="tab-content">
              <div class="results-grid">
                <div class="result-item">
                  <h3>Mean Execution Time</h3>
                  <p class="metric">
                    <app-time-format [duration]="resultStats()!.mean"></app-time-format>
                  </p>
                </div>
                
                <div class="result-item">
                  <h3>Operations per Second</h3>
                  <p class="metric highlight">{{ formatNumber(resultStats()!.operationsPerSecond, 0) }} ops/sec</p>
                </div>
                
                <div class="result-item">
                  <h3>Samples Collected</h3>
                  <p class="metric">{{ resultStats()!.successfulSamples }} / {{ result()!.samples.length }}</p>
                </div>
                
                <div class="result-item">
                  <h3>Total Time</h3>
                  <p class="metric">
                    <app-time-format [duration]="result()!.totalTime"></app-time-format>
                  </p>
                </div>
              </div>
            </div>
          </mat-tab>

          <!-- Detailed Statistics Tab -->
          <mat-tab label="Detailed Statistics">
            <div class="tab-content">
              <div class="detailed-stats">
                <h3>Statistical Analysis</h3>
                <div class="stats-table">
                  <div class="stat-row">
                    <span>Median:</span>
                    <span>
                      <app-time-format [duration]="resultStats()!.median"></app-time-format>
                    </span>
                  </div>
                  <div class="stat-row">
                    <span>Minimum:</span>
                    <span>
                      <app-time-format [duration]="resultStats()!.min"></app-time-format>
                    </span>
                  </div>
                  <div class="stat-row">
                    <span>Maximum:</span>
                    <span>
                      <app-time-format [duration]="resultStats()!.max"></app-time-format>
                    </span>
                  </div>
                  <div class="stat-row">
                    <span>Standard Deviation:</span>
                    <span>
                      <app-time-format [duration]="resultStats()!.standardDeviation"></app-time-format>
                    </span>
                  </div>
                  <div class="stat-row">
                    <span>Coefficient of Variation:</span>
                    <span>{{ formatNumber(resultStats()!.coefficientOfVariation * 100, 2) }}%</span>
                  </div>
                  <div class="stat-row">
                    <span>Failed Samples:</span>
                    <span>{{ resultStats()!.failedSamples }}</span>
                  </div>
                </div>
              </div>
            </div>
          </mat-tab>

          <!-- Performance Visualization Tab -->
          <mat-tab label="Performance Visualization">
            <div class="tab-content">
              <div class="charts-section">
                <h3>Performance Charts</h3>
                
                <div class="charts-grid">
                  @if (timeSeriesData()) {
                    <div class="chart-container">
                      <canvas 
                        baseChart
                        type="line"
                        [data]="timeSeriesData()!"
                        [options]="timeSeriesOptions"
                        width="400"
                        height="300">
                      </canvas>
                    </div>
                  }
                  
                  @if (histogramData()) {
                    <div class="chart-container">
                      <canvas 
                        baseChart
                        type="bar"
                        [data]="histogramData()!"
                        [options]="histogramOptions"
                        width="400"
                        height="300">
                      </canvas>
                    </div>
                  }
                  
                  @if (statsComparisonData()) {
                    <div class="chart-container chart-small">
                      <canvas 
                        baseChart
                        type="doughnut"
                        [data]="statsComparisonData()!"
                        [options]="statsComparisonOptions"
                        width="350"
                        height="350">
                      </canvas>
                    </div>
                  }
                </div>
              </div>
            </div>
          </mat-tab>
        </mat-tab-group>
      </div>
    }
  </main>
</div>
